---
import { type CollectionEntry, getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";

export async function getStaticPaths() {
    const posts = await getCollection("blog");
    return posts.map((post) => ({
        params: { slug: post.slug },
        props: post,
    }));
}
type Props = CollectionEntry<"blog">;

const post = Astro.props;
const { Content } = await post.render();
---

<BaseLayout title={post.data.title} description={post.data.description}>
    <article>
        <header style="margin-bottom: 3rem;">
            <time
                datetime={post.data.pubDate.toISOString()}
                style="font-weight: bold; background: var(--color-accent); color: white; padding: 0.25rem 0.5rem;"
            >
                {
                    post.data.pubDate.toLocaleDateString("en-us", {
                        year: "numeric",
                        month: "long",
                        day: "numeric",
                    })
                }
            </time>
            <h1 style="margin-top: 1.5rem;">{post.data.title}</h1>
            <p
                style="font-size: 1.5rem; font-style: italic; border-left: 10px solid var(--color-secondary); padding-left: 1rem; margin-top: 1rem;"
            >
                {post.data.description}
            </p>
        </header>
        <div class="prose">
            <Content />
        </div>
    </article>

    <div style="margin-top: 4rem;">
        <a href="/" class="brutalist-button">BACK TO BASE</a>
    </div>
</BaseLayout>

<style is:global>
    .prose h2 {
        margin-top: 2rem;
        border-bottom: 4px solid black;
        display: inline-block;
    }
    .prose p {
        margin: 1.5rem 0;
        font-size: 1.1rem;
    }
    .prose ul {
        margin: 1.5rem 0;
        padding-left: 2rem;
        list-style: square;
    }
    .prose li {
        margin-bottom: 0.5rem;
    }
    .prose pre {
        background: black;
        color: #00ff00;
        padding: 1.5rem;
        border: 4px solid var(--color-accent);
        margin: 2rem 0;
        overflow-x: auto;
    }
</style>
